helper={UI:{metaTitle:"#metatitle"},click:function(){var e=$(document);e.on("click","[data-action]",function(e){e.preventDefault();var t=$(e.currentTarget),o=t.attr("href")||t.attr("data-href"),n=t.attr("data-action");n.indexOf(":")>=0&&(n=n.split(":")),"object"==typeof n&&"undefined"!=typeof melody[n[0]][n[1]]?melody[n[0]][n[1]](o,t):"undefined"!=typeof melody[n]?melody[n](o,t):console.log('error : method "'+n+'" not found')})},ajax:function(e,t){melody.loading(),$(helper.UI.metaTitle).remove();var o={method:null!==e&&"string"==typeof e.method?e.method:"POST",url:null!==e&&"string"==typeof e.url?e.url:"#",dataType:null!==e&&"string"==typeof e.dataType?e.dataType:"html",data:null!==e&&"undefined"!=typeof e.data?e.data:null,updateUrl:null!==e&&"boolean"==typeof e.updateUrl?e.updateUrl:!0};o.updateUrl&&(helper.ga(o.url),helper.pushState(o.url)),$.ajax({url:o.url,method:o.method,dataType:o.datatype,data:o.data,headers:{"X-Requested-With":"BAWXMLHttpRequest"},complete:function(){},success:function(e){console.info("ajax success : "+o.url,o.data),melody.loading(!1),t(null,e)},error:function(e){console.error("ajax error : "+o.url,o.data),melody.loading(!1),t(e,null)}})},pushState:function(e){Modernizr.history&&window.history.pushState({},"melody",e)},metaTitle:function(){var e=$(helper.UI.metaTitle),t=e.text();"string"==typeof t&&(document.title=t,e.remove())},onPopState:function(){var e=$(window);e.on("load",function(){setTimeout(function(){window.onpopstate=function(e){"/"===document.location.pathname||""===document.location.pathname?document.location.reload():melody.loadContent(document.location.href,null)}},300)})},scrollWidth:function(){var e=document.createElement("div");e.style.visibility="hidden",e.style.width="100px",document.body.appendChild(e);var t=e.offsetWidth;e.style.overflow="scroll";var o=document.createElement("div");o.style.width="100%",e.appendChild(o);var n=o.offsetWidth;return e.parentNode.removeChild(e),t-n},ga:function(e,t){"function"==typeof ga&&(t="string"!=typeof t?"pageview":t,e="undefined"==typeof e?{}:e,ga("send",t,e))}},app={UI:{root:$("html, body"),html:$("html"),body:$("body")},init:function(){var e=$(window);e.on("resize",function(){app.onResize()}),helper.click(),helper.onPopState()},onResize:function(){},loading:function(e){"undefined"==typeof e||e===!0?app.UI.body.addClass("loading"):app.UI.body.removeClass("loading")},loadContent:function(e,t){Modernizr.history||(document.location.href=e);var o={url:e};helper.ajax(o,function(e,t){console.log(e,t),app.UI.body.html(t),helper.metaTitle()})}},$(function(){app.init()});